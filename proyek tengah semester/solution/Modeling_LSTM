{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"id":"1ZWMJsGWrxd6","executionInfo":{"status":"ok","timestamp":1651025409393,"user_tz":-420,"elapsed":1085,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","\n","from sklearn.feature_extraction.text import CountVectorizer\n","from sklearn.model_selection import cross_validate\n","from sklearn.metrics import confusion_matrix\n","\n","import warnings\n","warnings.filterwarnings(\"ignore\")"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19671,"status":"ok","timestamp":1651025429058,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"1IztnZJIr3Fs","outputId":"88c8019a-06d1-423e-9774-c450988a6d06"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":3,"metadata":{"id":"_mQiHMZ5r4s8","executionInfo":{"status":"ok","timestamp":1651025430005,"user_tz":-420,"elapsed":949,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["train = pd.read_csv(\"/content/drive/Shareddrives/tk1-anamedsos/df_name.csv\")"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"cxKrWI0sr9Hf","executionInfo":{"status":"ok","timestamp":1651025432285,"user_tz":-420,"elapsed":2282,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["import tensorflow as tf\n","from tensorflow.keras.preprocessing.text import Tokenizer\n","from tensorflow.keras.preprocessing.sequence import pad_sequences\n","from tensorflow.keras.utils import to_categorical"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"hjwOPTersR46","executionInfo":{"status":"ok","timestamp":1651025432285,"user_tz":-420,"elapsed":3,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["train.dropna(inplace=True)"]},{"cell_type":"code","execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":8,"status":"ok","timestamp":1651025432843,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"LeSbAbnE1bcK","outputId":"990c0d4d-1645-4564-c6d1-5288cda521c7"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(12713, 2)"]},"metadata":{},"execution_count":6}],"source":["train.shape"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"1dwswAFB1RXm","executionInfo":{"status":"ok","timestamp":1651025432843,"user_tz":-420,"elapsed":6,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["from sklearn.model_selection import train_test_split\n","train, val = train_test_split(train, test_size = 0.3, random_state=42)"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"Bz301M8msVXC","executionInfo":{"status":"ok","timestamp":1651025432843,"user_tz":-420,"elapsed":6,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["NUM_WORDS = 2000\n","OOV_TOKEN= \"<OOV>\""]},{"cell_type":"code","execution_count":9,"metadata":{"id":"cIO5GEdaspln","executionInfo":{"status":"ok","timestamp":1651025432843,"user_tz":-420,"elapsed":5,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["sentences = train['name']"]},{"cell_type":"code","execution_count":10,"metadata":{"id":"8InpIwLKsvGH","executionInfo":{"status":"ok","timestamp":1651025432844,"user_tz":-420,"elapsed":6,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["tokenizer = Tokenizer(num_words = NUM_WORDS, oov_token=OOV_TOKEN)\n","tokenizer.fit_on_texts(sentences)"]},{"cell_type":"code","execution_count":11,"metadata":{"id":"BWgkIqf8s3hb","executionInfo":{"status":"ok","timestamp":1651025432844,"user_tz":-420,"elapsed":6,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["sequences = tokenizer.texts_to_sequences(sentences)"]},{"cell_type":"code","execution_count":12,"metadata":{"id":"ikkDreJZuX36","executionInfo":{"status":"ok","timestamp":1651025432844,"user_tz":-420,"elapsed":6,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["max_length = 1024\n","trunc_type='post'\n","padding_type='post'"]},{"cell_type":"code","execution_count":13,"metadata":{"id":"hv49FUzDtd4z","executionInfo":{"status":"ok","timestamp":1651025432844,"user_tz":-420,"elapsed":6,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["padded = pad_sequences(sequences, maxlen=max_length, padding=padding_type, truncating=trunc_type)"]},{"cell_type":"code","execution_count":14,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1651025432844,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"M0l2LhUWtt7j","outputId":"0d123f01-6ce6-49ca-fff4-323251ab01dd"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[  4,   0,   0, ...,   0,   0,   0],\n","       [ 42,   1,   0, ...,   0,   0,   0],\n","       [  1,   0,   0, ...,   0,   0,   0],\n","       ...,\n","       [  1,   0,   0, ...,   0,   0,   0],\n","       [731,   0,   0, ...,   0,   0,   0],\n","       [  2,   1,   0, ...,   0,   0,   0]], dtype=int32)"]},"metadata":{},"execution_count":14}],"source":["padded"]},{"cell_type":"code","execution_count":15,"metadata":{"id":"gkP3JTdT18up","executionInfo":{"status":"ok","timestamp":1651025432844,"user_tz":-420,"elapsed":5,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["sentences_val = val['name']\n","sequences_val = tokenizer.texts_to_sequences(sentences_val)"]},{"cell_type":"code","execution_count":16,"metadata":{"id":"AAgClOcD2RcY","executionInfo":{"status":"ok","timestamp":1651025432844,"user_tz":-420,"elapsed":5,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["padded_val = pad_sequences(sequences_val, maxlen=max_length, padding=padding_type, truncating=trunc_type)"]},{"cell_type":"code","execution_count":17,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1325,"status":"ok","timestamp":1651025434165,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"ZA9X0lRst8oC","outputId":"f6f20b66-de24-4196-fc6c-3111bf265aa3"},"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"sequential\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," embedding (Embedding)       (None, 1024, 100)         200000    \n","                                                                 \n"," bidirectional (Bidirectiona  (None, 1024, 128)        84480     \n"," l)                                                              \n","                                                                 \n"," dropout (Dropout)           (None, 1024, 128)         0         \n","                                                                 \n"," lstm_1 (LSTM)               (None, 64)                49408     \n","                                                                 \n"," dense (Dense)               (None, 32)                2080      \n","                                                                 \n"," dense_1 (Dense)             (None, 16)                528       \n","                                                                 \n"," dense_2 (Dense)             (None, 1)                 17        \n","                                                                 \n","=================================================================\n","Total params: 336,513\n","Trainable params: 336,513\n","Non-trainable params: 0\n","_________________________________________________________________\n"]}],"source":["import tensorflow as tf\n","\n","# Parameters\n","embedding_dim = 100\n","lstm_dim = 64\n","dense_dim = 24\n","\n","# Model Definition with LSTM\n","model_lstm = tf.keras.Sequential([\n","    tf.keras.layers.Embedding(NUM_WORDS, embedding_dim, input_length=max_length),\n","    tf.keras.layers.Bidirectional(tf.keras.layers.LSTM(lstm_dim, return_sequences = True)),\n","    tf.keras.layers.Dropout(0.3),\n","    tf.keras.layers.LSTM(lstm_dim),\n","    tf.keras.layers.Dense(32, activation='relu',\n","                          kernel_regularizer=tf.keras.regularizers.L1(0.01),\n","                          activity_regularizer=tf.keras.regularizers.L2(0.01)),\n","    tf.keras.layers.Dense(16, activation='relu'),\n","    tf.keras.layers.Dense(1, activation='sigmoid')\n","])\n","\n","# Set the training parameters\n","model_lstm.compile(loss='binary_crossentropy',optimizer='adam',metrics=['accuracy', tf.keras.metrics.Recall(),tf.keras.metrics.Precision()])\n","\n","# Print the model summary\n","model_lstm.summary()"]},{"cell_type":"code","execution_count":18,"metadata":{"id":"jh09y5s4u-_U","executionInfo":{"status":"ok","timestamp":1651025434166,"user_tz":-420,"elapsed":4,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["labels = train[\"gender\"].values\n","labels = [1 if l == 'pria' else 0 for l in labels]"]},{"cell_type":"code","execution_count":19,"metadata":{"id":"iqlwxFxj2iwS","executionInfo":{"status":"ok","timestamp":1651025434166,"user_tz":-420,"elapsed":4,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["labels_val = val['gender'].values\n","labels_val = [1 if l == 'pria' else 0 for l in labels_val]"]},{"cell_type":"code","execution_count":20,"metadata":{"id":"PzQ0uRrJvfac","executionInfo":{"status":"ok","timestamp":1651025434166,"user_tz":-420,"elapsed":4,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["labels = np.array(labels)\n","labels_val = np.array(labels_val)"]},{"cell_type":"code","execution_count":21,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":427,"status":"ok","timestamp":1651025434590,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"A6m3LowrwJbu","outputId":"4c53e704-06ca-471f-9b4d-83f66fb12111"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(3814,)"]},"metadata":{},"execution_count":21}],"source":["labels_val.shape"]},{"cell_type":"code","execution_count":22,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"pyorhFjVvK0-","outputId":"5b599062-95de-4a62-8f63-258318b90471","executionInfo":{"status":"ok","timestamp":1651030985941,"user_tz":-420,"elapsed":5551356,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/15\n","18/18 [==============================] - 393s 21s/step - loss: 3.0555 - accuracy: 0.4907 - recall: 0.7553 - precision: 0.4964 - val_loss: 2.8672 - val_accuracy: 0.4955 - val_recall: 1.0000 - val_precision: 0.4955\n","Epoch 2/15\n","18/18 [==============================] - 372s 21s/step - loss: 2.7169 - accuracy: 0.5017 - recall: 0.9851 - precision: 0.5028 - val_loss: 2.5413 - val_accuracy: 0.4955 - val_recall: 1.0000 - val_precision: 0.4955\n","Epoch 3/15\n","18/18 [==============================] - 368s 21s/step - loss: 2.4026 - accuracy: 0.5038 - recall: 1.0000 - precision: 0.5038 - val_loss: 2.2420 - val_accuracy: 0.4955 - val_recall: 1.0000 - val_precision: 0.4955\n","Epoch 4/15\n","18/18 [==============================] - 381s 21s/step - loss: 2.1169 - accuracy: 0.5015 - recall: 0.9625 - precision: 0.5027 - val_loss: 1.9722 - val_accuracy: 0.4955 - val_recall: 1.0000 - val_precision: 0.4955\n","Epoch 5/15\n","18/18 [==============================] - 367s 20s/step - loss: 1.8587 - accuracy: 0.5038 - recall: 1.0000 - precision: 0.5038 - val_loss: 1.7274 - val_accuracy: 0.4955 - val_recall: 1.0000 - val_precision: 0.4955\n","Epoch 6/15\n","18/18 [==============================] - 362s 20s/step - loss: 1.6255 - accuracy: 0.5038 - recall: 1.0000 - precision: 0.5038 - val_loss: 1.5085 - val_accuracy: 0.4955 - val_recall: 1.0000 - val_precision: 0.4955\n","Epoch 7/15\n","18/18 [==============================] - 370s 21s/step - loss: 1.4188 - accuracy: 0.5038 - recall: 1.0000 - precision: 0.5038 - val_loss: 1.3168 - val_accuracy: 0.4955 - val_recall: 1.0000 - val_precision: 0.4955\n","Epoch 8/15\n","18/18 [==============================] - 365s 20s/step - loss: 1.2394 - accuracy: 0.5038 - recall: 1.0000 - precision: 0.5038 - val_loss: 1.1517 - val_accuracy: 0.4955 - val_recall: 1.0000 - val_precision: 0.4955\n","Epoch 9/15\n","18/18 [==============================] - 372s 21s/step - loss: 1.0845 - accuracy: 0.5038 - recall: 1.0000 - precision: 0.5038 - val_loss: 1.0094 - val_accuracy: 0.4955 - val_recall: 1.0000 - val_precision: 0.4955\n","Epoch 10/15\n","18/18 [==============================] - 371s 21s/step - loss: 0.9547 - accuracy: 0.5038 - recall: 1.0000 - precision: 0.5038 - val_loss: 0.8949 - val_accuracy: 0.4955 - val_recall: 1.0000 - val_precision: 0.4955\n","Epoch 11/15\n","18/18 [==============================] - 373s 21s/step - loss: 0.8533 - accuracy: 0.5038 - recall: 1.0000 - precision: 0.5038 - val_loss: 0.8081 - val_accuracy: 0.4955 - val_recall: 1.0000 - val_precision: 0.4955\n","Epoch 12/15\n","18/18 [==============================] - 369s 21s/step - loss: 0.7782 - accuracy: 0.5038 - recall: 1.0000 - precision: 0.5038 - val_loss: 0.7461 - val_accuracy: 0.4955 - val_recall: 1.0000 - val_precision: 0.4955\n","Epoch 13/15\n","18/18 [==============================] - 366s 20s/step - loss: 0.7268 - accuracy: 0.5038 - recall: 1.0000 - precision: 0.5038 - val_loss: 0.7093 - val_accuracy: 0.4955 - val_recall: 1.0000 - val_precision: 0.4955\n","Epoch 14/15\n","18/18 [==============================] - 366s 20s/step - loss: 0.7022 - accuracy: 0.5038 - recall: 1.0000 - precision: 0.5038 - val_loss: 0.6990 - val_accuracy: 0.4955 - val_recall: 1.0000 - val_precision: 0.4955\n","Epoch 15/15\n","18/18 [==============================] - 356s 20s/step - loss: 0.6975 - accuracy: 0.5038 - recall: 1.0000 - precision: 0.5038 - val_loss: 0.6966 - val_accuracy: 0.4955 - val_recall: 1.0000 - val_precision: 0.4955\n"]}],"source":["NUM_EPOCHS = 15\n","\n","# Train the model\n","history_lstm = model_lstm.fit(padded, labels, epochs=NUM_EPOCHS, batch_size=512 ,validation_data=(padded_val, labels_val))"]},{"cell_type":"code","execution_count":23,"metadata":{"id":"_NdKc6eQGDrq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1651031069294,"user_tz":-420,"elapsed":83372,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}},"outputId":"9066e080-d8e9-471d-f498-85bfbcf2b6a8"},"outputs":[{"output_type":"stream","name":"stdout","text":["120/120 [==============================] - 47s 378ms/step\n"]}],"source":["pred_val = (model_lstm.predict(padded_val, verbose=1) >= 0.5).astype(\"int32\")"]},{"cell_type":"code","execution_count":24,"metadata":{"id":"hyzj3gIrGD-i","executionInfo":{"status":"ok","timestamp":1651031069295,"user_tz":-420,"elapsed":17,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["from sklearn.metrics import confusion_matrix"]},{"cell_type":"code","execution_count":25,"metadata":{"id":"8c-qJJR5GEDm","executionInfo":{"status":"ok","timestamp":1651031069295,"user_tz":-420,"elapsed":15,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["pred_val = ['pria' if p[0] == 1 else 'wanita' for p in pred_val]"]},{"cell_type":"code","execution_count":26,"metadata":{"id":"HXm1kifnGEGA","executionInfo":{"status":"ok","timestamp":1651031069295,"user_tz":-420,"elapsed":15,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["val['pred'] = pred_val"]},{"cell_type":"code","source":["val"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":423},"id":"4iSATHo7H_XW","executionInfo":{"status":"ok","timestamp":1651031172869,"user_tz":-420,"elapsed":327,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}},"outputId":"a5d7604d-0fa3-4bd4-b69f-8850a1f72cb1"},"execution_count":29,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                  name  gender  pred\n","927            bontiet    pria  pria\n","8573    raisa andriana  wanita  pria\n","4067        endangjojo  wanita  pria\n","6963   mas aan rifanto    pria  pria\n","12008   sigit widianto    pria  pria\n","...                ...     ...   ...\n","1361         gak sangu    pria  pria\n","8092            pandhu    pria  pria\n","5226              hery    pria  pria\n","9223         black cat  wanita  pria\n","3809           dpp pkb  wanita  pria\n","\n","[3814 rows x 3 columns]"],"text/html":["\n","  <div id=\"df-d93729cd-ea8d-40e0-a8db-f9a9f938a277\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>name</th>\n","      <th>gender</th>\n","      <th>pred</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>927</th>\n","      <td>bontiet</td>\n","      <td>pria</td>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>8573</th>\n","      <td>raisa andriana</td>\n","      <td>wanita</td>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>4067</th>\n","      <td>endangjojo</td>\n","      <td>wanita</td>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>6963</th>\n","      <td>mas aan rifanto</td>\n","      <td>pria</td>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>12008</th>\n","      <td>sigit widianto</td>\n","      <td>pria</td>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>1361</th>\n","      <td>gak sangu</td>\n","      <td>pria</td>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>8092</th>\n","      <td>pandhu</td>\n","      <td>pria</td>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>5226</th>\n","      <td>hery</td>\n","      <td>pria</td>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>9223</th>\n","      <td>black cat</td>\n","      <td>wanita</td>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>3809</th>\n","      <td>dpp pkb</td>\n","      <td>wanita</td>\n","      <td>pria</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>3814 rows × 3 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d93729cd-ea8d-40e0-a8db-f9a9f938a277')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d93729cd-ea8d-40e0-a8db-f9a9f938a277 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d93729cd-ea8d-40e0-a8db-f9a9f938a277');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":29}]},{"cell_type":"code","execution_count":30,"metadata":{"id":"HGMGSY9lGEKz","executionInfo":{"status":"ok","timestamp":1651031173183,"user_tz":-420,"elapsed":2,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["val.to_csv('error_analysis')"]},{"cell_type":"code","execution_count":31,"metadata":{"id":"U-RUNAHdvZYS","executionInfo":{"status":"ok","timestamp":1651031180171,"user_tz":-420,"elapsed":6989,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["test = pd.read_csv(\"/content/drive/Shareddrives/tk1-anamedsos/test_clean.csv\")"]},{"cell_type":"code","execution_count":32,"metadata":{"id":"sXYnC-SkwmB6","executionInfo":{"status":"ok","timestamp":1651031180171,"user_tz":-420,"elapsed":2,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["test.fillna(' ', inplace=True)"]},{"cell_type":"code","execution_count":33,"metadata":{"id":"ezzYyXYmwnWR","executionInfo":{"status":"ok","timestamp":1651031180171,"user_tz":-420,"elapsed":2,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["sentences_test = test[\"tweet_clean\"]"]},{"cell_type":"code","execution_count":34,"metadata":{"id":"auhcadj0wpnI","executionInfo":{"status":"ok","timestamp":1651031203018,"user_tz":-420,"elapsed":22849,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["sequences_test = tokenizer.texts_to_sequences(sentences_test)"]},{"cell_type":"code","execution_count":35,"metadata":{"id":"FzQy-27owwmE","executionInfo":{"status":"ok","timestamp":1651031203018,"user_tz":-420,"elapsed":4,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["padded_test = pad_sequences(sequences_test, maxlen=max_length, padding=padding_type, truncating=trunc_type)"]},{"cell_type":"code","execution_count":36,"metadata":{"id":"-XXQcQEOxd4S","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1651031203018,"user_tz":-420,"elapsed":3,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}},"outputId":"a9aa050d-5e6d-4611-d4b9-2585761cf75c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[   1,    1,  629, ...,    1,    1,  150],\n","       [   1,    1,    1, ...,    1,    1, 1516],\n","       [   1,    1,    4, ...,    0,    0,    0],\n","       ...,\n","       [   1,    1,    1, ...,    0,    0,    0],\n","       [   1,    1,    1, ...,    1,    1,    1],\n","       [   1,    1,    1, ...,    1,    1,   37]], dtype=int32)"]},"metadata":{},"execution_count":36}],"source":["padded_test"]},{"cell_type":"code","execution_count":37,"metadata":{"id":"QlqjhnDexey9","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1651031216186,"user_tz":-420,"elapsed":13170,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}},"outputId":"2324d1bb-7acb-44bb-f4c8-c59f30d76d76"},"outputs":[{"output_type":"stream","name":"stdout","text":["33/33 [==============================] - 13s 390ms/step\n"]}],"source":["preds = (model_lstm.predict(padded_test, verbose=1) >= 0.5).astype(\"int32\")"]},{"cell_type":"code","execution_count":38,"metadata":{"id":"Grk25yLqzqA6","executionInfo":{"status":"ok","timestamp":1651031216186,"user_tz":-420,"elapsed":13,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["preds = ['pria' if p[0] == 1 else 'wanita' for p in preds]"]},{"cell_type":"code","execution_count":39,"metadata":{"id":"X_h_6D-2zDXB","executionInfo":{"status":"ok","timestamp":1651031216186,"user_tz":-420,"elapsed":12,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["df_test = pd.DataFrame(preds)"]},{"cell_type":"code","execution_count":40,"metadata":{"id":"H5B1qpO-z2aI","executionInfo":{"status":"ok","timestamp":1651031216186,"user_tz":-420,"elapsed":12,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["df_test.index = range(1,len(df_test)+1)"]},{"cell_type":"code","execution_count":41,"metadata":{"id":"FmhAr7VZ0ZbO","colab":{"base_uri":"https://localhost:8080/","height":0},"executionInfo":{"status":"ok","timestamp":1651031216187,"user_tz":-420,"elapsed":13,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}},"outputId":"9589a4dd-c4bf-481a-ceaf-cd8e30643875"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["         0\n","1     pria\n","2     pria\n","3     pria\n","4     pria\n","5     pria\n","...    ...\n","1050  pria\n","1051  pria\n","1052  pria\n","1053  pria\n","1054  pria\n","\n","[1054 rows x 1 columns]"],"text/html":["\n","  <div id=\"df-5dd1822a-e3b7-4177-9942-2edb870370a0\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>0</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>1050</th>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>1051</th>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>1052</th>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>1053</th>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>1054</th>\n","      <td>pria</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>1054 rows × 1 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5dd1822a-e3b7-4177-9942-2edb870370a0')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-5dd1822a-e3b7-4177-9942-2edb870370a0 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-5dd1822a-e3b7-4177-9942-2edb870370a0');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":41}],"source":["df_test"]},{"cell_type":"code","execution_count":42,"metadata":{"id":"2w3kZcXQ0bao","executionInfo":{"status":"ok","timestamp":1651031216187,"user_tz":-420,"elapsed":12,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":["df_test.to_csv(\"resultLSTM.csv\", header=False)"]},{"cell_type":"code","execution_count":42,"metadata":{"id":"jVQu3fJv0fgC","executionInfo":{"status":"ok","timestamp":1651031216187,"user_tz":-420,"elapsed":11,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}}},"outputs":[],"source":[""]}],"metadata":{"colab":{"collapsed_sections":[],"name":"Modeling_LSTM","provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}