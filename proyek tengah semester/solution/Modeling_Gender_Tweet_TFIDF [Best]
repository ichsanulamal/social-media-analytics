{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"BIV3cmzr5x7v"},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","\n","from sklearn.feature_extraction.text import CountVectorizer\n","from sklearn.model_selection import cross_validate\n","from sklearn.metrics import confusion_matrix\n","\n","import warnings\n","warnings.filterwarnings(\"ignore\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":15630,"status":"ok","timestamp":1650840094014,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"_8OYRtMd52Y4","outputId":"bbc6cbb8-0497-4da7-af8f-106025af63be"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"markdown","metadata":{"id":"7uamOWcMR1L6"},"source":["## Modeling Gender dengan Unstructured"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rGnzuKc1RD2G"},"outputs":[],"source":["df_train = pd.read_csv(\"/content/drive/Shareddrives/tk1-anamedsos/df_train.csv\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZxW3MDqrQXFA"},"outputs":[],"source":["df_train = df_train.drop(['Unnamed: 0'], axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1650840131142,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"Z0xAj7XtQXJB","outputId":"a0bd2c3f-7133-4237-cde2-9c086aef39a1"},"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 8799 entries, 0 to 8798\n","Data columns (total 7 columns):\n"," #   Column           Non-Null Count  Dtype  \n","---  ------           --------------  -----  \n"," 0   followers_count  8799 non-null   float64\n"," 1   following_count  8799 non-null   float64\n"," 2   gender           8799 non-null   object \n"," 3   listed_count     8799 non-null   float64\n"," 4   tweet_count      8799 non-null   float64\n"," 5   verified         8799 non-null   float64\n"," 6   tweet_clean      8799 non-null   object \n","dtypes: float64(5), object(2)\n","memory usage: 481.3+ KB\n"]}],"source":["df_train.info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"h6uwIWD19IUu"},"outputs":[],"source":["from sklearn.model_selection import train_test_split\n","from sklearn.feature_extraction.text import TfidfVectorizer"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"twRy0dq56YDn"},"outputs":[],"source":["vectorizer = TfidfVectorizer(ngram_range=(1, 1), max_features=2000)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"JQuHE51K9k1O"},"outputs":[],"source":["df_train, df_val = train_test_split(df_train, test_size=0.3, random_state=123)"]},{"cell_type":"code","source":["df_train = df_train.iloc[:2500]\n","df_val = df_val.iloc[:2500]"],"metadata":{"id":"boMAkYaHEdV6"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_val.gender.value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Vf8lhlBXJpZe","executionInfo":{"status":"ok","timestamp":1650840151566,"user_tz":-420,"elapsed":304,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}},"outputId":"a7de3982-ff3a-470b-fb01-3078b0c71781"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["pria      1253\n","wanita    1247\n","Name: gender, dtype: int64"]},"metadata":{},"execution_count":11}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"SZwpaJIHSlSh"},"outputs":[],"source":["df_train_num = df_train.select_dtypes('number')\n","df_train_obj = df_train.select_dtypes('object')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"TER7guISSlU3"},"outputs":[],"source":["df_val_num = df_val.select_dtypes('number')\n","df_val_obj = df_val.select_dtypes('object')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HiTJXfcnSlXM"},"outputs":[],"source":["tweets_train = df_train_obj['tweet_clean']\n","tweets_val = df_val_obj['tweet_clean']"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"B5vDOYyUSlZc"},"outputs":[],"source":["# tweets_vec_train = model.encode(tweets_train.tolist())\n","tweets_vec_train = vectorizer.fit_transform(np.array(tweets_train.tolist())).todense()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xetzSjj4Slbp"},"outputs":[],"source":["tweets_vec_val = vectorizer.transform(np.array(tweets_val.tolist())).todense()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8Arfs9rvSld4"},"outputs":[],"source":["labels_train = df_train_obj['gender']\n","labels_val = df_val_obj['gender']"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"K-gPA40MVXZn"},"outputs":[],"source":["# X_train = np.append(df_train_num.values, tweets_vec_train, axis=1)\n","X_train = tweets_vec_train"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":11,"status":"ok","timestamp":1650840238013,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"b4rcc1quUX4m","outputId":"aa093b31-5583-4be3-d84d-3a00e76b6909"},"outputs":[{"output_type":"stream","name":"stdout","text":["(2500, 2000)\n","(2500,)\n"]}],"source":["print(X_train.shape)\n","print(labels_train.shape)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NBMjmvf3UX6-"},"outputs":[],"source":["# X_val = np.append(df_val_num.values, tweets_vec_val, axis=1)\n","X_val = tweets_vec_val"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1650840238013,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"ye2tTH_0UX9m","outputId":"4deac5a9-9685-43b5-c2ce-1530611ca1e9"},"outputs":[{"output_type":"stream","name":"stdout","text":["(2500, 2000)\n","(2500,)\n"]}],"source":["print(X_val.shape)\n","print(labels_val.shape)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vMxHGzuoYRBP"},"outputs":[],"source":["y_train = labels_train\n","y_val = labels_val"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6351,"status":"ok","timestamp":1650840792475,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"lyGYUI-69yQf","outputId":"c38dc9df-376c-4cde-f33c-9573063085df"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["SVC(class_weight='balanced')"]},"metadata":{},"execution_count":23}],"source":["from sklearn.svm import SVC, LinearSVC\n","\n","svc = SVC(kernel=\"rbf\", class_weight='balanced')\n","svc.fit(X_train, y_train)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"byptQXy295lS"},"outputs":[],"source":["y_pred = svc.predict(X_val)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4,"status":"ok","timestamp":1650840801144,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"doEaQTKI-HYW","outputId":"e1b20824-1ff8-43af-f723-0627e43679a1"},"outputs":[{"output_type":"stream","name":"stdout","text":["              precision    recall  f1-score   support\n","\n","        pria       0.63      0.64      0.64      1253\n","      wanita       0.63      0.62      0.63      1247\n","\n","    accuracy                           0.63      2500\n","   macro avg       0.63      0.63      0.63      2500\n","weighted avg       0.63      0.63      0.63      2500\n","\n"]}],"source":["from sklearn.metrics import classification_report\n","print(classification_report(y_val, y_pred))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4225,"status":"ok","timestamp":1650840805365,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"BbmatTU--iaB","outputId":"e8075cd6-cb1a-485b-9d10-c7532a1b44b5"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["RandomForestClassifier(class_weight='balanced')"]},"metadata":{},"execution_count":26}],"source":["from sklearn.ensemble import RandomForestClassifier\n","\n","rf = RandomForestClassifier(class_weight='balanced')\n","rf.fit(X_train, y_train)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QmqBsguwAS8n"},"outputs":[],"source":["y_pred_rf = rf.predict(X_val)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":11,"status":"ok","timestamp":1650840805366,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"GaXLyatfAWZj","outputId":"782e1f03-f6bd-4f04-d1ae-af3aed57b313"},"outputs":[{"output_type":"stream","name":"stdout","text":["              precision    recall  f1-score   support\n","\n","        pria       0.65      0.68      0.66      1253\n","      wanita       0.66      0.62      0.64      1247\n","\n","    accuracy                           0.65      2500\n","   macro avg       0.65      0.65      0.65      2500\n","weighted avg       0.65      0.65      0.65      2500\n","\n"]}],"source":["print(classification_report(y_val, y_pred_rf))"]},{"cell_type":"code","source":["from sklearn.metrics import f1_score\n","f1_score(y_val, y_pred_rf, pos_label='wanita', average='macro')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5d-9mbL2KbRo","executionInfo":{"status":"ok","timestamp":1650840805367,"user_tz":-420,"elapsed":10,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}},"outputId":"c8602b94-94b3-4cd5-f2a3-c7d2d5b1017d"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.6536714588927639"]},"metadata":{},"execution_count":29}]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":38391,"status":"ok","timestamp":1650840843752,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"Pa8wU4KV-7Jy","outputId":"8b10d36b-a7ee-4fc5-f992-7e93808f91fe"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["AdaBoostClassifier(n_estimators=100)"]},"metadata":{},"execution_count":30}],"source":["from sklearn.ensemble import GradientBoostingClassifier, AdaBoostClassifier\n","\n","gb = AdaBoostClassifier(n_estimators=100)\n","gb.fit(X_train, y_train)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1037,"status":"ok","timestamp":1650840844771,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"87dbS1pc_SYv","outputId":"8805fcfa-5939-4e47-e9d7-dd0f5e422d28"},"outputs":[{"output_type":"stream","name":"stdout","text":["              precision    recall  f1-score   support\n","\n","        pria       0.63      0.59      0.61      1253\n","      wanita       0.61      0.65      0.63      1247\n","\n","    accuracy                           0.62      2500\n","   macro avg       0.62      0.62      0.62      2500\n","weighted avg       0.62      0.62      0.62      2500\n","\n"]}],"source":["y_pred_gb = gb.predict(X_val)\n","print(classification_report(y_val, y_pred_gb))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3868,"status":"ok","timestamp":1650840848635,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"oyRi9XB_WHmm","outputId":"8351c686-d019-469f-ac72-4f8754041992"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["MLPClassifier(hidden_layer_sizes=(128, 64, 64, 32), max_iter=100,\n","              random_state=1, solver='sgd')"]},"metadata":{},"execution_count":32}],"source":["from sklearn.neural_network import MLPClassifier\n","\n","mlp = MLPClassifier(\n","          hidden_layer_sizes=(128,64, 64, 32),\n","          max_iter=100,\n","          alpha=1e-4,\n","          solver=\"sgd\",\n","          random_state=1,\n","          learning_rate_init=0.001,\n","      )\n","mlp.fit(X_train, y_train)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":24,"status":"ok","timestamp":1650840848636,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"Fpy_ObLbWptZ","outputId":"c5011f79-be33-4388-9471-5aafa9cb1570"},"outputs":[{"output_type":"stream","name":"stdout","text":["              precision    recall  f1-score   support\n","\n","        pria       0.53      0.26      0.35      1253\n","      wanita       0.51      0.76      0.61      1247\n","\n","    accuracy                           0.51      2500\n","   macro avg       0.52      0.51      0.48      2500\n","weighted avg       0.52      0.51      0.48      2500\n","\n"]}],"source":["y_pred_mlp = mlp.predict(X_val)\n","print(classification_report(y_val, y_pred_mlp))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1174,"status":"ok","timestamp":1650840849792,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"ccvgPRHcY5NV","outputId":"31adff28-629e-4bb2-c2ca-ac23fbfe7d6a"},"outputs":[{"output_type":"stream","name":"stdout","text":["              precision    recall  f1-score   support\n","\n","        pria       0.61      0.42      0.49      1253\n","      wanita       0.56      0.73      0.63      1247\n","\n","    accuracy                           0.57      2500\n","   macro avg       0.58      0.57      0.56      2500\n","weighted avg       0.58      0.57      0.56      2500\n","\n"]}],"source":["from sklearn.neighbors import KNeighborsClassifier\n","\n","k = int(X_train.shape[0] ** 0.5)\n","knn = KNeighborsClassifier(n_neighbors=k)\n","\n","knn.fit(X_train, y_train)\n","y_pred_knn = knn.predict(X_val)\n","print(classification_report(y_val, y_pred_knn))"]},{"cell_type":"markdown","metadata":{"id":"r_S1IcC2Da8j"},"source":["Hyperparameter Tuning"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AkHVITw8DZjY"},"outputs":[],"source":["# from sklearn.model_selection import GridSearchCV"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"A6M4C99rFw3d"},"outputs":[],"source":["# def svc_param_selection(X, y, nfolds):\n","#     Cs = [0.001, 0.01, 0.1, 1, 10]\n","#     gammas = [0.001, 0.01, 0.1, 1]\n","#     param_grid = {'C': Cs, 'gamma' : gammas}\n","#     grid_search = GridSearchCV(SVC(kernel='rbf'), param_grid, cv=nfolds)\n","#     grid_search.fit(X, y)\n","#     grid_search.best_params_\n","#     return grid_search.best_params_"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1689975,"status":"ok","timestamp":1650433268085,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"025nd9ljUUxI","outputId":"c625d42f-ed0e-440a-df9b-89831187b0a9"},"outputs":[{"data":{"text/plain":["{'C': 1, 'gamma': 0.001}"]},"execution_count":97,"metadata":{},"output_type":"execute_result"}],"source":["# svc_param_selection(X_train, y_train, 5)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19625,"status":"ok","timestamp":1650433287702,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"TQIB4472Ua4R","outputId":"5bc5544c-fe3b-4d28-b4be-1453b1eb2091"},"outputs":[{"data":{"text/plain":["SVC(C=1, gamma=0.001)"]},"execution_count":98,"metadata":{},"output_type":"execute_result"}],"source":["# svc = SVC(kernel='rbf', C=1, gamma=0.001)\n","# svc.fit(X_train, y_train)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":10240,"status":"ok","timestamp":1650433297936,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"OUgxkMeRVnNy","outputId":"34be4edb-f02f-4a1a-bff4-28fd1f300b66"},"outputs":[{"name":"stdout","output_type":"stream","text":["              precision    recall  f1-score   support\n","\n","        pria       0.54      0.61      0.58      1321\n","      wanita       0.56      0.49      0.52      1319\n","\n","    accuracy                           0.55      2640\n","   macro avg       0.55      0.55      0.55      2640\n","weighted avg       0.55      0.55      0.55      2640\n","\n"]}],"source":["# y_pred = svc.predict(X_val)\n","# print(classification_report(y_val, y_pred_gb))"]},{"cell_type":"markdown","metadata":{"id":"A4LBJI0EAnyQ"},"source":["Modeling"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"UjtuRyIGAZdE"},"outputs":[],"source":["test = pd.read_csv(\"/content/drive/Shareddrives/tk1-anamedsos/test_clean.csv\")"]},{"cell_type":"code","source":["df_test = pd.read_excel(\"/content/drive/Shareddrives/tk1-anamedsos/df_testing_structured.xlsx\")"],"metadata":{"id":"Qsp0NvrcAaU_"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_test = df_test.select_dtypes('number').drop(['id'], axis=1)"],"metadata":{"id":"OiGUgUIEAj4a"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Z8nNeK_wf9If","colab":{"base_uri":"https://localhost:8080/","height":423},"executionInfo":{"status":"ok","timestamp":1650841558614,"user_tz":-420,"elapsed":4,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}},"outputId":"a4d04f13-c77e-438b-cf3d-c51831928a04"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["      Unnamed: 0        username  \\\n","0              0       lilithkis   \n","1              1      marioteguh   \n","2              2  flo_and_behold   \n","3              3       gwirjawan   \n","4              4      hary_tanoe   \n","...          ...             ...   \n","1049        1049   farreltangkas   \n","1050        1050    fithrisyamsu   \n","1051        1051         jojoxh_   \n","1052        1052      dpsungging   \n","1053        1053       tari_1314   \n","\n","                                                  tweet  \\\n","0     @swastiacintya @novemberdad Ya kamu<SEP>@swast...   \n","1     NANTI SORE di  https://t.co/h0sTzI6kj1  MTLV -...   \n","2                        Yaay! It was a fun session! :)   \n","3     Special screening film Nussa kemarin bareng pa...   \n","4     Pagi ini, Kamis, 27 Mei 2021, saya menerima ku...   \n","...                                                 ...   \n","1049  RT @WOWFAKTA: Sebelum tidur, kebanyakan orang ...   \n","1050  @MafiaWasit tas kresek katanya 👍🏻<SEP>@breadma...   \n","1051  College Golf Recruiting Swing Video https://t....   \n","1052  @josh_are_josie Ngiahahaha. Enak wae. Selalu n...   \n","1053  Tadi malem aku mimpiin kamu — Sama https://t.c...   \n","\n","                                            tweet_clean  \n","0     swastiacintya novemberdad ya swastiacintya nov...  \n","1     sore mtlv kurangi pamer kejutkan senin 31 mei ...  \n","2                                yaay was a fun session  \n","3     special screening film nussa kemarin bareng er...  \n","4     pagi kamis 27 mei 2021 menerima kunjungan ceo ...  \n","...                                                 ...  \n","1049  rt wowfakta tidur kebanyakan orang membayangka...  \n","1050  mafiawasit tas kresek breadmama3 rajapilem pol...  \n","1051                college golf recruiting swing video  \n","1052  josh_are_josie ngiahahaha enak wae ngbrol rt m...  \n","1053  malam mimpiin lapar makan haus minum kangen ke...  \n","\n","[1054 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-10baca7f-52af-47e9-a634-1dbe0cc3d498\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>username</th>\n","      <th>tweet</th>\n","      <th>tweet_clean</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>lilithkis</td>\n","      <td>@swastiacintya @novemberdad Ya kamu&lt;SEP&gt;@swast...</td>\n","      <td>swastiacintya novemberdad ya swastiacintya nov...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>marioteguh</td>\n","      <td>NANTI SORE di  https://t.co/h0sTzI6kj1  MTLV -...</td>\n","      <td>sore mtlv kurangi pamer kejutkan senin 31 mei ...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>flo_and_behold</td>\n","      <td>Yaay! It was a fun session! :)</td>\n","      <td>yaay was a fun session</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>gwirjawan</td>\n","      <td>Special screening film Nussa kemarin bareng pa...</td>\n","      <td>special screening film nussa kemarin bareng er...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>hary_tanoe</td>\n","      <td>Pagi ini, Kamis, 27 Mei 2021, saya menerima ku...</td>\n","      <td>pagi kamis 27 mei 2021 menerima kunjungan ceo ...</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>1049</th>\n","      <td>1049</td>\n","      <td>farreltangkas</td>\n","      <td>RT @WOWFAKTA: Sebelum tidur, kebanyakan orang ...</td>\n","      <td>rt wowfakta tidur kebanyakan orang membayangka...</td>\n","    </tr>\n","    <tr>\n","      <th>1050</th>\n","      <td>1050</td>\n","      <td>fithrisyamsu</td>\n","      <td>@MafiaWasit tas kresek katanya 👍🏻&lt;SEP&gt;@breadma...</td>\n","      <td>mafiawasit tas kresek breadmama3 rajapilem pol...</td>\n","    </tr>\n","    <tr>\n","      <th>1051</th>\n","      <td>1051</td>\n","      <td>jojoxh_</td>\n","      <td>College Golf Recruiting Swing Video https://t....</td>\n","      <td>college golf recruiting swing video</td>\n","    </tr>\n","    <tr>\n","      <th>1052</th>\n","      <td>1052</td>\n","      <td>dpsungging</td>\n","      <td>@josh_are_josie Ngiahahaha. Enak wae. Selalu n...</td>\n","      <td>josh_are_josie ngiahahaha enak wae ngbrol rt m...</td>\n","    </tr>\n","    <tr>\n","      <th>1053</th>\n","      <td>1053</td>\n","      <td>tari_1314</td>\n","      <td>Tadi malem aku mimpiin kamu — Sama https://t.c...</td>\n","      <td>malam mimpiin lapar makan haus minum kangen ke...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>1054 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-10baca7f-52af-47e9-a634-1dbe0cc3d498')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-10baca7f-52af-47e9-a634-1dbe0cc3d498 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-10baca7f-52af-47e9-a634-1dbe0cc3d498');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":39}],"source":["test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"jxHCwzpEgkWZ"},"outputs":[],"source":["import re\n","\n","def clean_tweet(tweet):\n","  clean_tw = re.sub(r\"\\d+\", \" \", tweet) # remove digit\n","  clean_tw = clean_tw.lower()\n","  clean_tw = re.sub(\"url\", \" \", clean_tw)\n","  clean_tw = re.sub(\"username\", \" \", clean_tw)\n","  clean_tw = re.sub(\"sensitive-no\", \" \", clean_tw)\n","  clean_tw = re.sub(\"sep\", \" \", clean_tw)\n","  clean_tw = re.sub(r\"https?:\\/[^\\s]*\", \" \", clean_tw) # remove http tag\n","  clean_tw = re.sub(r\"[^\\w\\s]\", \" \", clean_tw)\n","  clean_tw = re.sub(r\"#[^\\s]*\", \" \", clean_tw)\n","  clean_tw = re.sub(r\"@[^\\s]*\", \" \", clean_tw)\n","  normal_regex = re.compile(r\"(.)\\1{1,}\")\n","  clean_tw = normal_regex.sub(r\"\\1\\1\", clean_tw) # remove consecutive word\n","  clean_tw = re.sub(r\"\\s+\", \" \", clean_tw) # remove excessive space\n","  clean_tw = clean_tw.strip()\n","  return clean_tw"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3An3D9D6YqcN"},"outputs":[],"source":["test.fillna(' ', inplace=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mQaK0zkqgHB2"},"outputs":[],"source":["tweets_test = test['tweet_clean'].tolist()\n","tweets_test = [clean_tweet(tweet) for tweet in tweets_test]\n","test['tweet_clean'] = tweets_test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IHVnEbz1gqT3","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1650841577136,"user_tz":-420,"elapsed":5,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"}},"outputId":"4f76248d-824c-454f-ea93-59d07b67c549"},"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 1054 entries, 0 to 1053\n","Data columns (total 4 columns):\n"," #   Column       Non-Null Count  Dtype \n","---  ------       --------------  ----- \n"," 0   Unnamed: 0   1054 non-null   int64 \n"," 1   username     1054 non-null   object\n"," 2   tweet        1054 non-null   object\n"," 3   tweet_clean  1054 non-null   object\n","dtypes: int64(1), object(3)\n","memory usage: 33.1+ KB\n"]}],"source":["test.info()"]},{"cell_type":"code","source":["# num_feat = df_test.values\n","# num_feat"],"metadata":{"id":"kP-8lF3xBdfW"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zTcT3maJV5cT"},"outputs":[],"source":["tweets_test = test[\"tweet_clean\"]\n","X_test = vectorizer.transform(np.array(tweets_test.tolist())).todense()"]},{"cell_type":"code","source":["# X_test = np.append(num_feat, X_test, axis=1)"],"metadata":{"id":"_O8Nj9ebBp-B"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":12,"status":"ok","timestamp":1650841590282,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"oNFb4KzoWunb","outputId":"9cf1efb2-8e29-46ac-84f4-de2e5bd2d94f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1054, 2000)"]},"metadata":{},"execution_count":47}],"source":["X_test.shape"]},{"cell_type":"code","source":["# X_test = scaler.transform(X_test)"],"metadata":{"id":"tQiad9drB63x"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YiqjsoWeWVXh"},"outputs":[],"source":["y_test = rf.predict(X_test)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13,"status":"ok","timestamp":1650841590285,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"TIbCO5iRWe5c","outputId":"ef3fdb80-4f45-460f-c578-a7c49ea1b995"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array(['wanita', 'pria', 'wanita', ..., 'wanita', 'wanita', 'wanita'],\n","      dtype=object)"]},"metadata":{},"execution_count":50}],"source":["y_test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vAq9YiygWl6e"},"outputs":[],"source":["df_test = pd.DataFrame(y_test)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_Oa_K-G0a6cf"},"outputs":[],"source":["df_test.index = range(1,len(df_test)+1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":423},"executionInfo":{"elapsed":12,"status":"ok","timestamp":1650841590287,"user":{"displayName":"Daniel Syahputra Purba","userId":"16062251870246311539"},"user_tz":-420},"id":"qSup9CR2bLzJ","outputId":"76062315-d085-4c85-857e-133466033813"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["           0\n","1     wanita\n","2       pria\n","3     wanita\n","4       pria\n","5       pria\n","...      ...\n","1050    pria\n","1051  wanita\n","1052  wanita\n","1053  wanita\n","1054  wanita\n","\n","[1054 rows x 1 columns]"],"text/html":["\n","  <div id=\"df-2bad6907-8601-44c1-9103-c446de66ad0e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>0</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>wanita</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>wanita</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>1050</th>\n","      <td>pria</td>\n","    </tr>\n","    <tr>\n","      <th>1051</th>\n","      <td>wanita</td>\n","    </tr>\n","    <tr>\n","      <th>1052</th>\n","      <td>wanita</td>\n","    </tr>\n","    <tr>\n","      <th>1053</th>\n","      <td>wanita</td>\n","    </tr>\n","    <tr>\n","      <th>1054</th>\n","      <td>wanita</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>1054 rows × 1 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2bad6907-8601-44c1-9103-c446de66ad0e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-2bad6907-8601-44c1-9103-c446de66ad0e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-2bad6907-8601-44c1-9103-c446de66ad0e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":53}],"source":["df_test"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WK7rDFXoZ0cB"},"outputs":[],"source":["df_test.to_csv(\"resultGender.csv\", header=False)"]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":[],"name":"Modeling_Gender_Tweet_TFIDF [Best]","provenance":[],"authorship_tag":"ABX9TyO890VYdwfzsx5Z4FroB0IO"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}